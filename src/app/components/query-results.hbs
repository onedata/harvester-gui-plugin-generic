<div class="query-results">
  <div class="results-header">
    <QueryResults::FilteredPropertiesSelector
      @queryResults={{this.queryResults}}
      @onSelectionChange={{this.filteredPropertiesChanged}}
    />
    {{#if this.queryResults.results}}
      <QueryResults::SortSelector 
        @index={{this.index}}
        @sortProperty={{this.sortProperty}}
        @sortDirection={{this.sortDirection}}
        @onSortChange={{this.onSortChange}}
      />
      <QueryResults::Pagination
        @resultsCount={{this.queryResults.totalResultsCount}}
        @activePageNumber={{this.activePageNumber}}
        @pageSize={{this.pageSize}}
        @onPageChange={{this.onPageChange}}
        @onPageSizeChange={{this.onPageSizeChange}}
      />
    {{/if}}
  </div>
  <PromiseLoader
    @promise={{@queryResultsPromise}}
    @onResolve={{this.gotNewQueryResults}}
    @onReject={{fn this.gotNewQueryResults this.emptyQueryResults}}
    as |queryResults|
  >
    {{#if queryResults.results}}
      <ul class="results-list">
        {{#each queryResults.results as |queryResult|}}
          <QueryResults::Result
            @queryResult={{queryResult}}
            @filteredProperties={{this.filteredProperties}}
          />
        {{/each}}
      </ul>
      <QueryResults::Pagination
        @resultsCount={{queryResults.totalResultsCount}}
        @activePageNumber={{this.activePageNumber}}
        @pageSize={{this.pageSize}}
        @onPageChange={{this.onPageChange}}
        @onPageSizeChange={{this.onPageSizeChange}}
      />
    {{/if}}
  </PromiseLoader>
</div>
{{yield}}
